#include <Wire.h>



const int MPU6050_ADDR = 0x68;
const int GYRO_ZOUT_H = 0x47;
const float GYRO_SENSITIVITY = 131.0;

float yaw = 0;
unsigned long previousTime;

void setup() {
  Wire.begin();
  Serial.begin(9600);

  Wire.beginTransmission(MPU6050_ADDR);
  Wire.write(0x6B);
  Wire.write(0);
  Wire.endTransmission(true);

  previousTime = millis();
}

void loop() {
  unsigned long currentTime = millis();
  float dt = (currentTime - previousTime) / 1000.0;
  previousTime = currentTime;

  Wire.beginTransmission(MPU6050_ADDR);
  Wire.write(GYRO_ZOUT_H);
  Wire.endTransmission(false);
  Wire.requestFrom(MPU6050_ADDR, 2, true);

  int16_t gyroZ = Wire.read() << 8 | Wire.read();
  float gyroZRate = gyroZ / GYRO_SENSITIVITY;
  yaw += gyroZRate * dt;

  Serial.println(yaw);

  delay(100);
}
